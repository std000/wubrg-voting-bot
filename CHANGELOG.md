# –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## [Unreleased] - 2025-11-20

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
- **üî• –ü–æ–¥–¥–µ—Ä–∂–∫–∞ inline-–ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ poll_chats**
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `inline_message_id` –≤ —Ç–∞–±–ª–∏—Ü—É `voting.poll_chats`
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `message_hash` (BIGINT) –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
  - –ü–æ–ª—è `chat_id` –∏ `message_id` —Ç–µ–ø–µ—Ä—å nullable (–¥–ª—è inline-—Å–æ–æ–±—â–µ–Ω–∏–π)
  - –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∏ inline-—Å–æ–æ–±—â–µ–Ω–∏–π

- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ inline-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
  - –§—É–Ω–∫—Ü–∏—è `handleChosenInlineResult()` –≤ bot/poll.go
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ inline
  - –ë—ã—Å—Ç—Ä–∞—è —Ö–µ—à-—Ñ—É–Ω–∫—Ü–∏—è `FastHash()` –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–π
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö inline-–ø—É–±–ª–∏–∫–∞—Ü–∏–π

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
  - `db-schema/add_inline_support_to_poll_chats.sql` - –º–∏–≥—Ä–∞—Ü–∏—è –ë–î
  - `db-schema/APPLY_INLINE_SUPPORT.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
  - `db-schema/INLINE_SUPPORT_QUICKSTART.md` - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ `db-schema/schema.sql` —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `OnChosenInlineResult` –≤ bot/bot.go
- –£–ø—Ä–æ—â–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã `poll_chats` - —É–±—Ä–∞–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ constraint

## [Previous] - 2025-11-15

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL**
  - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (main.go)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –±–æ—Ç–∞
  - –ü–µ—Ä–µ–¥–∞—á–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É Bot

- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π –≤ –ë–î**
  - –§—É–Ω–∫—Ü–∏—è `savePollToDB()` –≤ bot/poll.go
  - –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –∏ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
  - –í–æ–∑–≤—Ä–∞—Ç ID —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –ë–î

- **üì≤ Inline-—Ä–µ–∂–∏–º (NEW!)**
  - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ inline-–∑–∞–ø—Ä–æ—Å–æ–≤ `handleInlineQuery()` –≤ bot/poll.go
  - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–∞ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ `@bot_name` –≤ –ª—é–±–æ–º —á–∞—Ç–µ
  - –ü–æ–∏—Å–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≤ inline-—Ä–µ–∂–∏–º–µ
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π (–¥–æ 20 —à—Ç—É–∫)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ inline-–∫–Ω–æ–ø–æ–∫ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
  - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
  - `INTEGRATION.md` - –æ–ø–∏—Å–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ë–î
  - `TESTING.md` - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
  - `INLINE_MODE.md` - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ inline-—Ä–µ–∂–∏–º—É (NEW!)
  - –û–±–Ω–æ–≤–ª–µ–Ω `CLAUDE.md` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
  - –î–æ–±–∞–≤–ª–µ–Ω—ã SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `queries.sql`

### üîß –ò–∑–º–µ–Ω–µ–Ω–æ
- –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –∫–æ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –≤ main.go
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `context` –≤ bot/poll.go
- –§—É–Ω–∫—Ü–∏—è `handlePollConfirmInput()` —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ë–î –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/help` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ inline-—Ä–µ–∂–∏–º–µ
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ `OnQuery` –≤ bot/bot.go

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ö–µ–º–∞ `voting` —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏:
- `voting.polls` - –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è—Ö
- `voting.poll_options` - –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
- `voting.poll_chats` - —á–∞—Ç—ã —Å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–º–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è–º–∏ (–ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- `voting.votes` - –≥–æ–ª–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ `/createpoll`
2. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ (3-200 —Å–∏–º–≤–æ–ª–æ–≤)
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ (–º–∏–Ω–∏–º—É–º 2, –º–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤ –∫–∞–∂–¥—ã–π)
4. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
5. ‚úÖ –í–æ–∑–≤—Ä–∞—Ç ID –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
6. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ë–î

### –ß—Ç–æ –µ—â–µ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ inline-–∫–Ω–æ–ø–æ–∫ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫ (callback queries) (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É `voting.votes` (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤ —á–∞—Ç—ã (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ Inline-—Ä–µ–∂–∏–º –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π –∏–∑ –ª—é–±–æ–≥–æ —á–∞—Ç–∞ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚è≥ –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: `/mypolls`, `/results`, `/close`, `/delete`
- ‚è≥ –ê–Ω–æ–Ω–∏–º–Ω–æ–µ/–Ω–µ–∞–Ω–æ–Ω–∏–º–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ
- ‚è≥ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
brew services start postgresql

# 2. –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb wubrg_voting

# 3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É
psql -U postgres -d wubrg_voting -f db-schema/schema.sql

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
export BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω"

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
go run main.go

# 6. –í Telegram: —Å–æ–∑–¥–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ
/createpoll
[—Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –±–æ—Ç–∞]

# 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î
psql -U postgres -d wubrg_voting
SELECT * FROM voting.polls ORDER BY id DESC LIMIT 1;

# 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ inline-—Ä–µ–∂–∏–º–∞
# 8.1. –í–∫–ª—é—á–∏—Ç—å inline-—Ä–µ–∂–∏–º –≤ BotFather:
#      - –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather
#      - –û—Ç–ø—Ä–∞–≤—å—Ç–µ /setinline
#      - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
#      - –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏: "–ü–æ–∏—Å–∫ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π..."
#
# 8.2. –í –ª—é–±–æ–º —á–∞—Ç–µ Telegram –≤–≤–µ–¥–∏—Ç–µ:
#      @your_bot_name
#
# 8.3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∏—Å–∫:
#      @your_bot_name –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
#
# 8.4. –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ —á–∞—Ç
#
# 8.5. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
#
# 8.6. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –ë–î:
psql -U postgres -d wubrg_voting
SELECT * FROM voting.votes ORDER BY voted_at DESC LIMIT 5;
```

–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: 
- –°–º. `TESTING.md` –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –°–º. `INLINE_MODE.md` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è inline-—Ä–µ–∂–∏–º–∞

