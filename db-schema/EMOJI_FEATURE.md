# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —ç–º–æ–¥–∑–∏ –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

## –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏. –¢–µ–ø–µ—Ä—å –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏ üëç –¥–ª—è –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤, –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —ç–º–æ–¥–∑–∏, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø—Ä–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è.

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤–æ–µ –ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ `voting.poll_options`

- **–ü–æ–ª–µ**: `emoji` (TEXT, nullable)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –≠–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–æ–≤ –∑–∞ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç
- **–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: NULL –≤ –ë–î, 'üëç' –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–¥–µ –µ—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `PollOption` (bot/poll.go)

–î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ –ø–æ–ª–µ:

```go
type PollOption struct {
    ID    int64
    Text  string
    Emoji string  // <- –ù–æ–≤–æ–µ –ø–æ–ª–µ
    Votes []Vote
}
```

### –§—É–Ω–∫—Ü–∏—è `getPollData`

–û–±–Ω–æ–≤–ª–µ–Ω SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–º–æ–¥–∑–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π NULL –∑–Ω–∞—á–µ–Ω–∏–π:

```go
SELECT id, option_text, emoji 
FROM voting.poll_options 
WHERE poll_id = $1 
ORDER BY id

// –í –∫–æ–¥–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º NULL –∑–Ω–∞—á–µ–Ω–∏–µ
var emoji *string
if err := optRows.Scan(&opt.ID, &opt.Text, &emoji); err != nil {
    return nil, err
}
// –ï—Å–ª–∏ emoji NULL –∏–ª–∏ –ø—É—Å—Ç–æ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º üëç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
if emoji != nil && *emoji != "" {
    opt.Emoji = *emoji
} else {
    opt.Emoji = "üëç"
}
```

### –§—É–Ω–∫—Ü–∏—è `formatPollMessage`

–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —ç–º–æ–¥–∑–∏ –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

```go
thumbs := strings.Repeat(opt.Emoji, thumbsCount)
if thumbs == "" && voteCount > 0 {
    thumbs = opt.Emoji
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ —ç–º–æ–¥–∑–∏

```sql
-- –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –æ —Ü–≤–µ—Ç–∞—Ö Magic: The Gathering
INSERT INTO voting.poll_options (poll_id, option_text, emoji) VALUES 
    (1, '‚ö™ –ë–µ–ª—ã–π (White)', '‚ö™'),
    (1, 'üîµ –°–∏–Ω–∏–π (Blue)', 'üîµ'),
    (1, '‚ö´ –ß–µ—Ä–Ω—ã–π (Black)', '‚ö´'),
    (1, 'üî¥ –ö—Ä–∞—Å–Ω—ã–π (Red)', 'üî¥'),
    (1, 'üü¢ –ó–µ–ª–µ–Ω—ã–π (Green)', 'üü¢');
```

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–¢–µ–ø–µ—Ä—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ç–∞–∫:

```
‚ö™ –ë–µ–ª—ã–π (White) ‚Äì 5
‚ö™‚ö™‚ö™ 25%
@user1, @user2, @user3

üîµ –°–∏–Ω–∏–π (Blue) ‚Äì 10
üîµüîµüîµüîµüîµüîµ 50%
@user4, @user5, @user6...
```

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –±—É–¥—É—Ç –∏–º–µ—Ç—å NULL –≤ –ø–æ–ª–µ emoji
- –í –∫–æ–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è üëç –¥–ª—è –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Å NULL –∏–ª–∏ –ø—É—Å—Ç—ã–º emoji
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è —ç–º–æ–¥–∑–∏, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è üëç
- –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–Ω–∞ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

## –§–∞–π–ª—ã, –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

1. `db-schema/schema.sql` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã
2. `db-schema/add_emoji_column.sql` - –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ë–î
3. `db-schema/sample_data.sql` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
4. `db-schema/queries.sql` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
5. `bot/poll.go` - –æ–±–Ω–æ–≤–ª–µ–Ω –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–º–æ–¥–∑–∏

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é

–°–º. [MIGRATION_INSTRUCTIONS.md](MIGRATION_INSTRUCTIONS.md)

